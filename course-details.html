<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Course Details</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>

body{
margin:0;
font-family:'Poppins',sans-serif;
background:#0f172a;
color:white;
}

/* HERO */
.hero{
width:100%;
height:320px;
background:#000;
overflow:hidden;
position:relative;
}

.hero video{
width:100%;
height:100%;
object-fit:cover;
}

/* CONTENT AREA */
.wrapper{
max-width:1100px;
margin:40px auto;
padding:0 20px;
display:flex;
gap:40px;
align-items:flex-start;
}

/* LEFT CONTENT */
.main{
flex:2;
}

.title{
font-size:28px;
font-weight:700;
margin-bottom:8px;
}

.meta{
font-size:13px;
color:#94a3b8;
margin-bottom:4px;
}

.rating{
font-size:13px;
color:#facc15;
margin:8px 0 15px;
}

.section{
background:#1e293b;
padding:25px;
border-radius:18px;
margin-top:20px;
box-shadow:0 6px 25px rgba(0,0,0,0.4);
line-height:1.6;
color:#cbd5e1;
}

/* SIDEBAR */
.sidebar{
flex:1;
position:sticky;
top:30px;
}

.price-box{
background:#1e293b;
padding:25px;
border-radius:18px;
box-shadow:0 10px 30px rgba(0,0,0,0.5);
text-align:center;
}

.price{
font-size:24px;
font-weight:700;
color:#22c55e;
margin-bottom:15px;
}

.buy-btn{
width:100%;
padding:12px;
background:#22c55e;
border:none;
border-radius:10px;
color:white;
font-weight:600;
cursor:pointer;
transition:0.3s;
}

.buy-btn:hover{
background:#16a34a;
}

.feature{
font-size:12px;
color:#94a3b8;
margin-top:8px;
}

/* LOADING */
.loading{
text-align:center;
margin-top:150px;
color:#94a3b8;
}

/* RESPONSIVE */
@media(max-width:900px){
.wrapper{
flex-direction:column;
}
.sidebar{
position:static;
}
}

</style>
</head>

<body>

<div id="loading" class="loading">Loading course...</div>

<div id="coursePage" style="display:none;">

<div class="hero" id="heroVideo"></div>

<div class="wrapper">

<div class="main">
<div class="title" id="title"></div>

<div class="meta" id="instructor"></div>
<div class="meta" id="category"></div>
<div class="meta" id="students"></div>

<div class="rating" id="rating"></div>

<div class="section">
<h3>About This Course</h3>
<p id="description"></p>
</div>
</div>

<div class="sidebar">
<div class="price-box">

<div class="price" id="price"></div>

<button class="buy-btn" id="buyBtn"></button>

<div class="feature">✔ Lifetime access</div>
<div class="feature">✔ Mobile & Desktop</div>
<div class="feature">✔ Certificate Included</div>

</div>
</div>

</div>

</div>

<script type="module">

import { app } from "./js/firebase.js";
import { getFirestore,doc,getDoc } 
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const db = getFirestore(app);

const params = new URLSearchParams(window.location.search);
const courseId = params.get("id");

if(!courseId){
window.location="market.html";
}

const snap = await getDoc(doc(db,"courses",courseId));

if(!snap.exists()){
window.location="market.html";
}

const c = snap.data();

document.getElementById("loading").style.display="none";
document.getElementById("coursePage").style.display="block";

/* HERO VIDEO */
document.getElementById("heroVideo").innerHTML =
`<video controls>
<source src="${c.video}" type="video/mp4">
</video>`;

/* DATA */
document.getElementById("title").innerText = c.title;
document.getElementById("instructor").innerText = "Instructor: "+(c.instructorName||"Instructor");
document.getElementById("category").innerText = "Category: "+(c.category||"General");
document.getElementById("students").innerText = (c.students||0)+" students enrolled";
document.getElementById("rating").innerText =
"⭐ "+(c.ratingAvg||0).toFixed(1)+" ("+(c.ratingCount||0)+" reviews)";
document.getElementById("description").innerText =
c.description || "No description available";

document.getElementById("price").innerText =
c.price>0 ? "₹ "+c.price : "Free";

const btn = document.getElementById("buyBtn");

if(c.price>0){
btn.innerText="Buy Course";
btn.onclick=()=>{ window.location="payment.html?course="+courseId; };
}else{
btn.innerText="Enroll Free";
btn.onclick=()=>{ alert("Enrolled Successfully!"); };
}

</script>

</body>
</html>
