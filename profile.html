<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile | Adhyayana</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:'Poppins',sans-serif;
}

/* Background with soft glow */
body{
background:#0f172a;
color:white;
min-height:100vh;
display:flex;
overflow:hidden;
}

body::before{
content:"";
position:absolute;
width:500px;
height:500px;
background:radial-gradient(circle,#2563eb,#0f172a);
top:-200px;
left:-200px;
filter:blur(120px);
opacity:.4;
z-index:-1;
}

body::after{
content:"";
position:absolute;
width:500px;
height:500px;
background:radial-gradient(circle,#22c55e,#0f172a);
bottom:-200px;
right:-200px;
filter:blur(120px);
opacity:.4;
z-index:-1;
}

/* SIDEBAR */

.sidebar{
width:250px;
background:rgba(17,24,39,.9);
backdrop-filter:blur(20px);
padding:30px 20px;
box-shadow:5px 0 30px rgba(0,0,0,.4);
transition:.4s;
}

.brand{
text-align:center;
margin-bottom:40px;
}

.brand img{
width:75px;
margin-bottom:10px;
transition:.4s;
}

.brand img:hover{
transform:rotate(8deg) scale(1.1);
}

.brand h2{
font-weight:600;
letter-spacing:1px;
}

.nav-link{
display:block;
padding:12px 14px;
margin:10px 0;
color:#94a3b8;
text-decoration:none;
border-radius:12px;
transition:.3s;
}

.nav-link:hover{
background:#2563eb;
color:white;
transform:translateX(6px);
}

.active{
background:#2563eb;
color:white;
}

.logout-btn{
margin-top:30px;
width:100%;
padding:12px;
border:none;
border-radius:10px;
background:#ef4444;
color:white;
cursor:pointer;
transition:.3s;
}

.logout-btn:hover{
background:#dc2626;
transform:translateY(-3px);
}

/* MAIN */

.main{
flex:1;
padding:50px;
overflow:auto;
animation:fadeIn .6s ease;
}

@keyframes fadeIn{
from{opacity:0;transform:translateY(20px);}
to{opacity:1;transform:translateY(0);}
}

.profile-container{
display:grid;
grid-template-columns:350px 1fr;
gap:30px;
}

/* Cards with glass effect */

.card{
background:rgba(30,41,59,.8);
backdrop-filter:blur(25px);
padding:35px;
border-radius:20px;
box-shadow:0 25px 60px rgba(0,0,0,.6);
transition:.4s;
}

.card:hover{
transform:translateY(-6px);
}

/* Profile image animation */

.profile-img{
width:190px;
height:190px;
border-radius:50%;
object-fit:cover;
border:6px solid #22c55e;
margin-bottom:20px;
transition:.6s;
}

.profile-img:hover{
transform:scale(1.08) rotate(6deg);
}

/* Buttons modern */

button{
padding:12px;
border:none;
border-radius:10px;
cursor:pointer;
margin-top:12px;
font-weight:500;
transition:.3s;
}

.upload-btn{
background:#334155;
color:white;
width:100%;
}

.upload-btn:hover{
background:#475569;
}

.edit-btn{
background:#6366f1;
color:white;
width:100%;
}

.edit-btn:hover{
background:#4f46e5;
}

.save-btn{
background:#22c55e;
color:white;
width:100%;
}

.save-btn:hover{
background:#16a34a;
}

/* Inputs */

input{
width:100%;
padding:12px;
margin:10px 0;
border-radius:8px;
border:none;
background:#0f172a;
color:white;
outline:none;
transition:.3s;
}

input:focus{
box-shadow:0 0 0 2px #22c55e;
}

.hidden{display:none;}
  
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
<div class="brand">
<img src="logo.png">
<h2>Adhyayana</h2>
</div>

<a href="dashboard.html" class="nav-link">Dashboard</a>
<a href="market.html" class="nav-link">Marketplace</a>
<a href="profile.html" class="nav-link active">Profile</a>

<button class="logout-btn" onclick="logout()">Logout</button>
</div>

<!-- MAIN -->
<div class="main">

<h2>My Profile</h2>
<br>

<div class="profile-container">

<!-- LEFT -->
<div class="card" style="text-align:center;">
<img id="profileImage" class="profile-img">
<input type="file" id="photoInput" hidden accept="image/*">

<button class="upload-btn" onclick="photoInput.click()">Upload Photo</button>
<button class="edit-btn" onclick="enableEdit()">Edit Profile</button>
</div>

<!-- RIGHT -->
<div class="card">

<div id="viewMode">
<p><strong>Name:</strong> <span id="viewName"></span></p>
<p><strong>Email:</strong> <span id="viewEmail"></span></p>
<p><strong>Category:</strong> <span id="viewCategory"></span></p>
<p><strong>Skills:</strong> <span id="viewSkills"></span></p>
<p><strong>Address:</strong> <span id="viewAddress"></span></p>
</div>

<div id="editMode" class="hidden">
<input type="text" id="nameInput" placeholder="Full Name">
<input type="text" id="categoryInput" placeholder="Category">
<input type="text" id="skillsInput" placeholder="Skills">
<input type="text" id="addressInput" placeholder="Address">
<button class="save-btn" onclick="saveProfile()">Save Changes</button>
</div>

</div>

</div>

</div>

<script type="module">

import { initializeApp, getApps } 
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";

import { 
  getAuth,
  onAuthStateChanged,
  signOut,
  setPersistence,
  browserLocalPersistence
} 
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

/* SAME CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyC0HLb1TVf3vJCQEQr2pUOonoXoKnjbrtw",
  authDomain: "login-65d4b.firebaseapp.com",
  projectId: "login-65d4b",
  storageBucket: "login-65d4b.appspot.com",
  messagingSenderId: "239979806578",
  appId: "1:239979806578:web:65db25b7e975ef0f1867eb"
};

/* SAFE INIT */
const app = getApps().length === 0 
  ? initializeApp(firebaseConfig)
  : getApps()[0];

const auth = getAuth(app);

await setPersistence(auth, browserLocalPersistence);

let userProfile = null;

/* AUTH STATE */
onAuthStateChanged(auth, (user) => {

  if (!user) {
    window.location.replace("login.html");
    return;
  }

  let storedProfile = JSON.parse(localStorage.getItem("currentUser"));

  if (!storedProfile || storedProfile.uid !== user.uid) {
    storedProfile = {
      uid: user.uid,
      name: user.displayName || user.email.split("@")[0],
      email: user.email,
      category: "Not Set",
      skills: "Not Set",
      address: "Not Set",
      photo: user.photoURL || "images/user.png"
    };
    localStorage.setItem("currentUser", JSON.stringify(storedProfile));
  }

  userProfile = storedProfile;
  loadProfile();
});

/* LOAD PROFILE */
function loadProfile(){
  document.getElementById("viewName").innerText=userProfile.name;
  document.getElementById("viewEmail").innerText=userProfile.email;
  document.getElementById("viewCategory").innerText=userProfile.category;
  document.getElementById("viewSkills").innerText=userProfile.skills;
  document.getElementById("viewAddress").innerText=userProfile.address;
  document.getElementById("profileImage").src=userProfile.photo;
}

/* KEEP YOUR OLD FUNCTIONS */
window.enableEdit = function(){
  document.getElementById("viewMode").classList.add("hidden");
  document.getElementById("editMode").classList.remove("hidden");

  nameInput.value=userProfile.name;
  categoryInput.value=userProfile.category;
  skillsInput.value=userProfile.skills;
  addressInput.value=userProfile.address;
}

window.saveProfile = function(){

  userProfile.name=nameInput.value;
  userProfile.category=categoryInput.value;
  userProfile.skills=skillsInput.value;
  userProfile.address=addressInput.value;

  localStorage.setItem("currentUser",JSON.stringify(userProfile));

  document.getElementById("editMode").classList.add("hidden");
  document.getElementById("viewMode").classList.remove("hidden");

  loadProfile();
  alert("Profile Updated!");
}

document.getElementById("photoInput").addEventListener("change",function(){
  const file=this.files[0];
  if(!file) return;

  const reader=new FileReader();
  reader.onload=function(e){
    userProfile.photo=e.target.result;
    localStorage.setItem("currentUser",JSON.stringify(userProfile));
    loadProfile();
  };
  reader.readAsDataURL(file);
});

window.logout = async function(){
  await signOut(auth);
  localStorage.removeItem("currentUser");
  window.location.replace("login.html");
}

</script>



</body>
</html>




